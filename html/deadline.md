<head>
	<link rel="stylesheet" href="../css/textstyles.css">

</style>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script>
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

</head>
<body>

## Проклятие режиссёра

Построение пуассоновского процесса с помощью разбрасывания событий по временной шкале, может дать нам ещё один поучительный урок. Пусть события перестанут быть независимыми, а образуют упорядоченную цепочку. Cкажем, в цепочке $\{A,B,C\}$ событие $B$ может случиться только после события $A$ и перед событием $C$, хотя моменты в которые эти события произойдут остаются случайными. Посмотрим, как разместятся такие упорядоченные цепочки на ограниченном временном интервале. Первое событие мы расположим в произвольной точке, второе обязательно позднее первого, третье &mdash; после второго и так далее. Для каждого следующего события будет оставаться всё меньше и меньше времени, так что перед дедлайном должно наблюдаться заметное увеличение интенсивности процесса. Назовём построенный нами процесс <dfn>стохастической цепочкой с дедлайном</dfn>. На рисунке показан пример построенной таким образом цепочки из $15$ событий, отражающих этапы выполнения какой-либо работы.

![Пример стохастической цепочки с дедлайном. Обратите внимание на то, что оси графика приведены к общему числу дел и всему отпущенному времени. Это позволит нам сравнивать, как разные сроки, так и различные по длине цепочки.](figures/deadline/fig1.svg)

Ступенчатая кривая показывает процесс подсчёта событий по мере течения времени, а пунктирная кривая &mdash; теоретическое ожидание числа событий или <dfn>темп выполнения работы</dfn>. Наблюдаемый темп, увы сильно неравномерен: в первую половину срока будет сделано едва ли $10\%$ работы, а добрую половину всех дел придётся выполнять, имея в своём распоряжении мене $10\%$ времени, но главная особенность: темп стремительно увеличивается при приближении к дедлайну! Мы получили модель предновогоднего ража или паники в преддверии годового отчёта, а также нащупали закон подлости, знакомый всякому, организовывавшему концерт, костюмированный вечер или иное мероприятие: 

<div class='law'>
Cколько бы времени ни было отпущено на подготовку мероприятия, большая часть дел останется на последнюю ночь!
</div> 

Прекрасные живые примеры таких процессов описаны, например, в рассказах Карела Чапека "Как делают газету" и "Как ставят пьесу". Неужели причина этого проклятия только в нашей неорганизованности и безалаберности? Не&nbsp;совсем так. Давайте разбираться. 

Пусть в распоряжении режиссёра имеется $N$ дней для постановки некоего действа. Подготовка разбивается на $M$ последовательных этапов, каждый из которых требует не менее дня на выполнение. Какова вероятность не уложиться в срок, реализуя описанный нами процесс выполнения работ? Если подготовка мероприятия требует вовлечения разных людей и различных производственных процессов, то возможны накладки, болезни или попросу хандра &mdash; все предпосылки к реализации нашей стохастической цепочки с дедлайном. Обратимся к имитационному моделированию и выясним, как распределяется длина цепочек, которые *не удалось* уместить в ограниченный промежуток времени, заданной длины. Вот что получается для $N=10$:

![Плотность вероятности для цепочек, которые не удалось сделать в отведённое время. Шансов не успеть сделать одно дело нет совсем. Короткие цепочки из двух дел составляют десятую часть общего числа &mdash; это такие неудачные цепочки, которые начались в последний день (из десяти) и не оставили времени на продолжение. Доля очень длинных цепочек, ожидаемо, невелика и уменьшается с увеличением их длины, практически исчезая для значений $M > 8$. Десять дел можно успеть сделать, если делать их каждый день: в первый день &mdash; первое (с вероятностью $1/10$), во второй &mdash; второе (с вероятностью $1/9$) и т.д. Вероятность случайно выдержать такой темп будет равна $1/10!$, что уже, практически, невероятно.](figures/deadline/fig3.svg)

Мода (максимум) распределения говорит нам о том какой длины цепочки чаще всего удаётся реализовать в отпущенный срок. Значения моды и среднего значения оказываются пропорциональны логарифму от $N$ и растут с увеличением выделяемого на работу времени крайне медленно. 

Для ответа на наш вопрос: какова вероятность, не уложиться в $N$ дней, имея перед собой $M$ последовательных этапов выполнения задачи, нам лучше использовать не плотность распределения вероятности, а кумулятивное распределение. Построим такие распределения для $N = 7,\ 30,\ 365$ и $25000$, соответствующие неделе, месяцу, году и (условно) всей жизни.

![Распределение вероятности не успеть выполнить цепочки различной длины в срок][fig4]

[fig4]: figures/deadline/fig4.svg "Распределение вероятности не успеть достигнуть цели в срок." width=500px

Каждая кривая показывает вероятность не успеть выполнить цепочку, состоящую из $M$ дел в выделенный срок. Эти графики говорят нам, например, о том, что вероятность не уложиться в месяц с заданием, имеющим $5$ шагов, превышает $80\%$. И что неорганизованному балбесу в неделю лучше не планировать более трёх дел, а десяток дел он не сделает, с вероятностью, превышающей $50\%$, и за всю жизнь! Действительно, мы видим, что при увеличении сроков на несколько порядков, число выполнимых как попало дел увеличивается незначительно. 

Ожидаемый темп выполнения работы зависит от числа дел в цепочке. В свою очередь, как мы увидели, число выполнимых дел логарифмически зависит от выделенного времени. Например, если каждый этап требует около дня работы, то вот как будет выглядеть ожидаемый темп для недели, месяца, и года:

![Наиболее вероятный темп выполнения работы в ограниченный срок. Интересно, что жёсткое ограничение по времени влияет благотворно. Имя в запасе всего неделю, мы, скорее всего, станем выполнять работу равномернее (к половине срока будет готова треть работы), а если впереди целый год, то можно и расслабиться... ну, а потом об этом пожалеть.](figures/deadline/fig2.svg)

 У идеального исполнителя-перфекциониста, который выполняет работу абсолютно равномерно, темп выполнения должен стремиться к диагонали (синяя пунктирная линия на рисунке). Это похоже на кривую равенства на диаграмме Лоренца, знаменующую справедливость. Подобно тому как мы вычисляли коэффициент Джини для диаграммы Лоренца, мы можем, основываясь на площади между кривой темпа выполнения работ и идеальныой кривой, вычислить некий коэффициент подлости, который покажет насколько мы далеки от идеала. Он зависит от длины выделенного срока и потихоньку увеличивается с ростом $N$. В приведённых нами примерах для недели, месяца и года, коэффициент подлости равен, соответственно $0.25$, $0.44$ и $0.65$.

Как же бороться с нарастающей волной забот и цейтнотом? Можно, например, взять себя в руки. Человек с синдромом отличника может стремиться сделать следующее дело как можно раньше, насколько это возможно, конечно. Правдоподобной моделью будет выбор момента для выполнения следующего дела, следуя экспоненциальному распределению с плотностью обратно пропорциональной оставшемуся времени. Это не исключит некоторой неопределённости, но выразит благие стремления делать все дела как можно скорее. Вот какими будут распределения вероятностей выполнения заданий в срок для аккуратиста, который в половине случаев сделает очередное дело в первую четверть оставшегося времени:

![Распределение вероятности не успеть в срок для аккуратиста][fig5]

[fig5]: figures/deadline/fig5.svg "Распределение вероятности не успеть в срок для аккуратиста."
width=500px

Существенно лучше! В течение недели можно с неплохой вероятностью успеть сделать пять дел и оставить себе два выходных дня. Но всё-же, для больших периодов увеличение возможностей не революционное. Проблема кроется в том, что ожидаемое число успешно завершаемых дел всё равно остаётся пропорциональным логарифму отпущенного времени, а логарифм растёт чрезвычайно медленно! Так что, планируя многое, нужно иметь в виду, что интенсивность процесса будет неизбежно возрастать, и времени в преддверии дедлайна, скорее всего, будет не хватать. В любом случае, необходимо помнить, что жизнь коротка и чтобы успеть реализовать задуманное, нужно действовать прямо сейчас!

Давайте полюбуемся на то, как распределяются дела у нашего отличника, приверженного экспоненциальному распределению.

![Ожидаемый темп выполнения работы методичным человеком, старающимся приступить к следующему этапу работы как можно скорее. На графиках представлены результаты усреднения десятка тысяч численных экспериментов, моделирующих выполнение задания с указанным числом этапов. Красной пунктирной линией обозначен предельный темп для большого числа задач.](figures/deadline/fig6.svg)

Нашему аккуратисту удалось более равномерно распределить работу, и сделать существенно больше дел, но его всё равно ожидает цейтнот. Короткие цепочки такой человек будет выполнять с существенным перевыполнением плана, а цепочку из семи дел -- практически идеально. Однако по мере увеличения числа дел, ожидаемый темп быстро стремится к пределу с коэффициентом подлости около $0.6$. Увеличилась общая производительность, но запарка перед самым дедлайном никуда не делись.

Впрочем, существует один широко известный способ существеено дисциплинировать выполнение работ: вместо одного дедлайна надо сделать их много! Давайте разобьем срок выполнения работы на две равные части и будем придерживаться этого нового дедлайна, считая его, скажем, промежуточным отчётом. Для каждой из этих частей мы можем построить кривую ожидаемого темпа выполнения работ, как показанано на рисунке.

![Разбиение времени выполнения работы на несколько промежуточных отчётных периодов позволяет выполнить работу более равномерно, но добавляет стресс при приближении каждого нового отчёта.](figures/deadline/fig7.svg)

Несмотря на нервотрёпку с промежуточным отчётом, мы достигли свое цели: площадь под общей кривой темпа выполнения сократилась и коэффициент подлости уменьшился от $0.65$ до $0.3$. Кроме того, сокращение срока (вместе с сокращением числа дел, разумеется) приближает ожидаемый темп выполнения работы к идеальному, поэтому коэффициент подлости уменьшился более чем в два раза. Добавление ещё двух, скажем, квартальных отчётов, уменьшат его уже до $0.13$, но тем самым мы вгоним наших исполнителей сразу в четыре стрессовых периода и они всё равно станут громко страдать, жалуясь на судьбу и на начальство! Что же, мы можем показать работникам наши выкладки и доказать, что введя ежеквартальную отчётность, в пять раз понизили коэффициент подлости их жизни, если это, конечно, послужит им утешением.

<stars>* * *</stars>

И, напоследок, ещё один фокус, проливающий свет на жизненные невзгоды. Что если добавить к построенному нами процессу выполнения цепочки дел какие-либо независящие от нас редкие неприятности: пургу, жуткую пробку, насморк, или всенародный праздник? 

Наша стохастическая цепочка &mdash; это неоднородный пуассоновский процесс, интенсивность которого монотонно и стремительно растёт. А для пуассоновского процесса определён *процесс случайного прореживания*, заключающийся в том, что мы с какой-то вероятностью станем удалять события из потока. Так вот, случайное прореживание с вероятностью $(1-p)$ оставляет процесс пуассоновским, но его интенсивность уменьшается, умножаясь на $p$. События, соответствующие *совпадению неприятности и какого-либо этапа выполнения работы* сами образуют пуассоновский процесс, с существенно меньшей интенсивностью, но в нашем случае, также, монотонно и стремительно растущей. Так стремительно, что какой бы малой ни была вероятность неприятности, для достаточно большого числа дел (или срока, отведённого на работу), ближе к дедлайну она увеличится до вполне наблюдаемой. И принтер забарахлит именно накануне сдачи курсовика! 

Не удивляйтесь если автобус сломается именно тогда, когда вы уже опаздываете. Автобус не желает вам зла. Просто, если вы девушка, то последовательность дел: выбрать платье, сьесть конфетку, умыться, надеть выбранное платье, накраситься, надеть цепочку, переложить вещи из сумочки в клатч, почистить туфли и прочее и прочее подходит к самому главному и волнительному дедлайну &mdash; к свиданию! И темп с которым вы летите навстречу судьбе уже такой сумасшедший, что начинают происходить самые маловероятные чудеса. К тому же, вам вполне простительно немного опаздать, есди вы девушка, разумеется.

</body>
