<!DOCTYPE html>
<html>
    <head>
    <meta charset='UTF-8'/>
    <script src='../lib/d3.js'></script>
    <script src='../lib/analysis.js'></script>
    <script src='../lib/functions.js'></script>
    <script src='../lib/tools.js'></script>
    <script src='../lib/matrix.js'></script>
    <script src='../lib/statistics.js'></script>
    <script src='../lib/graphics.js'></script>
    <script src='../lib/signal.js'></script>
    <script src='../lib/odesolve.js'></script>
    <script src='./toast.js'></script>
    <script src='./Butter2.js'></script>
    <link rel="stylesheet" href="../css/bw.css">
    <style>
    </style>
    </head>
    <body></body>
    <script>
    
      // Рис. 3.1
      function fig31()
      {
	  var h = new Histogram(5).fromDistribution(Gamma(50,0.5),1000)
	  new Graphics(createSVG('fig1'))
	      .xRange([0,200])
	      .yRange([0,40])
	      .histogram(h)
	      .plot(x => Gamma(50,0.5).PDF(x)*1000)
	      .axes({
		  xLabel : "уровень воды (см)",
		  yLabel : "число наблюдений",
//		  yTickFormat: fmt.percent05,
//		  yTickValues : range(0,0.045,0.005)
		    })
	  new Graphics(createSVG('fig2'),{'left-margin':55})
	      .xRange([0,20])
	      .yRange([0,0.3])
	      .discretePlot(Poisson(4).PMF,{'class':'pdf'})
	      .axes({
		  xLabel : "число машин",
		  yLabel : "вероятность наблюдения",
		  yTickFormat: fmt.percent,
		  yTickValues : range(0,0.35,0.05)
	      })
      }
      fig31()

      
      // Рис. 3.2
      function fig32()
      {
	  new Graphics(createSVG('fig3'),{'left-margin':55})
	      .xRange([0,20])
	      .yRange([0,0.15])
	      .plot(Uniform([3,15]).PDF,{'plotPoints':300})
	      .axes({
		  'xLabel' : "размеры бутерброда (см)",
		  'yLabel' : "плотность вероятности",
		  yTickValues: range(0,0.16,0.02)
	      })
	 
      }
      fig32()

      // Рис. 3.3
      function fig33()
      {
	  new Graphics(createSVG('fig4'))
	      .xRange([0,1])
	      .yRange([0,5])
	      .plot(Gamma(8,25).PDF)
	      .axes({	xLabel : "коэффициент трения",
			yLabel : "плотность вероятности",
			yTickValues : range(0,6)
		    })
	 
      }      
      fig33()

      // Рис. 3.4
      function fig34()
      {
	  new Graphics(createSVG('fig5'))
	      .xRange([0,3])
	      .yRange([0,2])
	      .plot(Exponential(2).PDF)
	      .axes({	xLabel : "начальная горизонтальная скорость (м/с)",
			yLabel : "плотность вероятности",
			xTickValues: range(0,3,0.5),
			yTickValues: range(0,2.5,0.5)})
	 
      }      
      fig34()

      // Рис. 3.5
      function fig35()
      {
	  var xs = datum[0].transpose()[0]
	  var d1 = datum[0].transpose()[1]
	  
	  var n = Normal(0,0.003).generator
	  new Graphics(createSVG('fig6'),{'size':500,'aspectRatio':1/2,'left-margin':60})
	      .xRange([0,200])
	      .yRange([0,1])
	      .listPlot(xs.take(35).map(x => x*20-14).zip(d1.map(x => 0.15*(x - 0.5)+0.5+n())))
	      .axes({ xLabel : "высота стола (в см)",
		      yLabel : "вероятность падения маслом вниз",
		      yTickFormat : fmt.percent})
	 
      }
      fig35()
      
      // Рис. 3.6
      function fig36()
      {
	  var xs = datum[0].transpose()[0]
	  var d1 = datum[0].transpose()[1]
	  
	  var n = Normal(0,0.0004).generator
	  new Graphics(createSVG('fig7'),{'size':500,'aspectRatio':1/2,'left-margin':60})
	      .xRange([0,200])
	      .yRange([0,1])
	      .listPlot(xs.take(35).map(x => x*20-14).zip(d1.map(x => 0.18*(x - 0.5)+0.51+n())))
	      .axes({ xLabel : "высота стола (в см)",
		      yLabel : "вероятность падения маслом вниз",
		      yTickFormat : fmt.percent})
	 
      }
      fig36()

      // Рис. 3.7
      function fig37()
      { 
	  new Graphics(createSVG('fig8'),{'size':500,'aspectRatio':1/2,'left-margin':60})
	      .xRange([0,15])
	      .yRange([0,1])
	      .listPlot(datum[1].take(55).map(([x,y])=>[x-0.75,y]))
	      .listPlot(datum[3].take(55).map(([x,y])=>[x-0.75,y]),{'points':false, 'marker':marker[0]})
	      .axes({ xLabel : "высота стола (в бутербродах)",
		      yLabel : "вероятность падения маслом вниз",
		      yTickFormat : fmt.percent})

	 
      }
      fig37()

      // Рис. 3.8
      function fig38()
      { 
	  new Graphics(createSVG('fig9'),{'size':500,'aspectRatio':1/2,'left-margin':60})
	      .xRange([0,50])
	      .yRange([0,1])
	      .listPlot(pts2.map(([x,y]) => [x/2,y]))
	      .axes({ xLabel : "высота стола (в бутербродах)",
		      yLabel : "вероятность падения маслом вниз",
		      yTickFormat : fmt.percent})
	 
      }
      fig38()
      
      // Рис. 3.9
      function fig39()
      {
	  var dd=[[2.25,0.32692307692307687],[3.25,1],[4.25,1],[5.25,1],[6.25,0.9230769230769231],[7.25,0.5],[8.25,0.3653846153846154],[9.25,0.11538461538461542],[10.25,0.07692307692307687],[11.25,0.019230769230769273],[12.25,0.019230769230769273],[13.25,0.07692307692307687],[14.25,0.05769230769230771],[15.25,0.23076923076923073],[16.25,0.3846153846153846],[17.25,0.5384615384615384],[18.25,0.7307692307692308],[19.25,0.6923076923076923],[20.25,0.8846153846153846],[21.25,0.75],[22.25,0.9230769230769231],[23.25,0.9615384615384616],[24.25,0.8846153846153846],[25.25,0.8653846153846154],[26.25,0.9230769230769231],[27.25,0.9230769230769231],[28.25,0.6730769230769231],[29.25,0.7115384615384616],[30.25,0.5192307692307692],[31.25,0.5],[32.25,0.5],[33.25,0.3076923076923077],[34.25,0.2692307692307693],[35.25,0.25],[36.25,0.3076923076923077],[37.25,0.21153846153846156],[38.25,0.17307692307692313],[39.25,0.13461538461538458],[40.25,0.23076923076923073],[41.25,0.17307692307692313],[42.25,0.1923076923076923],[43.25,0.11538461538461542],[44.25,0.15384615384615385],[45.25,0.25],[46.25,0.34615384615384615],[47.25,0.3846153846153846],[48.25,0.5192307692307692],[49.25,0.5576923076923077],[50.25,0.5576923076923077],[51.25,0.4807692307692307],[52.25,0.5769230769230769],[53.25,0.5961538461538461],[54.25,0.5961538461538461],[55.25,0.7115384615384616],[56.25,0.6730769230769231],[57.25,0.7884615384615384],[58.25,0.6346153846153846],[59.25,0.6923076923076923],[60.25,0.7692307692307692],[61.25,0.8269230769230769],[62.25,0.75],[63.25,0.75],[64.25,0.75],[65.25,0.7307692307692308],[66.25,0.6346153846153846],[67.25,0.7307692307692308],[68.25,0.5769230769230769],[69.25,0.7115384615384616],[70.25,0.6346153846153846],[71.25,0.5384615384615384],[72.25,0.5192307692307692],[73.25,0.46153846153846156],[74.25,0.40384615384615385],[75.25,0.5192307692307692],[76.25,0.5],[77.25,0.34615384615384615],[78.25,0.3653846153846154],[79.25,0.34615384615384615],[80.25,0.4423076923076923],[81.25,0.28846153846153844],[82.25,0.34615384615384615],[83.25,0.32692307692307687],[84.25,0.28846153846153844],[85.25,0.3076923076923077],[86.25,0.40384615384615385],[87.25,0.32692307692307687],[88.25,0.23076923076923073],[89.25,0.23076923076923073],[90.25,0.42307692307692313],[91.25,0.42307692307692313],[92.25,0.40384615384615385],[93.25,0.42307692307692313],[94.25,0.46153846153846156],[95.25,0.34615384615384615],[96.25,0.46153846153846156],[97.25,0.3076923076923077],[98.25,0.25],[99.25,0.4423076923076923],[100.25,0.3846153846153846],[101.25,0.5],[102.25,0.5769230769230769],[103.25,0.5576923076923077],[104.25,0.5961538461538461],[105.25,0.5384615384615384],[106.25,0.5576923076923077],[107.25,0.7307692307692308],[108.25,0.6153846153846154],[109.25,0.6346153846153846],[110.25,0.6538461538461539],[111.25,0.3846153846153846],[112.25,0.6153846153846154],[113.25,0.6730769230769231],[114.25,0.5769230769230769],[115.25,0.7307692307692308],[116.25,0.5961538461538461],[117.25,0.6346153846153846],[118.25,0.5192307692307692],[119.25,0.6538461538461539],[120.25,0.6923076923076923],[121.25,0.5576923076923077],[122.25,0.6730769230769231],[123.25,0.5961538461538461],[124.25,0.5],[125.25,0.5961538461538461],[126.25,0.5576923076923077],[127.25,0.5],[128.25,0.3846153846153846]]
	  n = 5000
	  f = x => 0.5*(1+Math.sign(cos(2.2*sqrt(x))))
	  P = x => 2*range(0.5,1,1/n).map(a => f(a/(1-a)*x)).sum()/n
	  P2 = x => max(0,min(1,6*(P(x)-0.5)+0.5))
	  plt = range(1,130,0.1).map(x => [x-1/2,P2(x)])
	  pts = range(1,130,1).map(x => [x-0.3,max(0,min(1,P2(x)+Normal(0,0.001).generator()))])
	  new Graphics(createSVG('fig39'),{'size':500,'aspectRatio':1/2,'left-margin':60})
	      .xRange([0,130])
	      .yRange([0,1])
    	      .listPlot(dd)
	      .listPlot(plt,{'joined':true,'points':false})
	      .axes({	xLabel : "высота падения (в бутербродах)",
			yLabel : "вероятность падения маслом вниз",
			yTickFormat : fmt.percent
		    })
	      .gridLines({y:[0.5]})
      }

      fig39()
     
    </script>
